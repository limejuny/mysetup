- name: Upgrade apt
  apt: upgrade=yes
  when: package_upgrade
  become: true
  become_user: root
  become_method: sudo

- name: Add neovim ppa
  become: true
  ansible.builtin.apt_repository:
    repo: 'ppa:neovim-ppa/stable'

- name: Install apt packages
  apt:
    name: "{{ item }}"
    update_cache: yes
  become: true
  become_user: root
  become_method: sudo
  loop: "{{ packages }}"

- name: Remove apt packages
  apt:
    name: "{{ item }}"
    update_cache: yes
    state: absent
  become: true
  become_user: root
  become_method: sudo
  loop: "{{ remove_packages }}"
